<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xsyx.dao.PickupMerchantsDao">




    <!-- resultMap映射 -->
    <resultMap id="PickupMerchantsMap" type="PickupMerchants">
        <id column="id" property="id"/>
        <result column="remark" property="remark"/>
        <result column="create_time" property="createTime"/>
        <association property="user" column="{fk=user}"
           select="com.xsyx.dao.UserDao.a_User_By_user" javaType="User" fetchType="lazy"/>
        <association property="merchant" column="{fk=merchant}"
           select="com.xsyx.dao.MerchantsDao.a_Merchants_By_merchant" javaType="Merchants" fetchType="lazy"/>
    </resultMap>

    <!-- 查询所有方法 -->
    <select id="queryAll" resultMap="PickupMerchantsMap">
       select create_time,merchant,remark,id,user from pickup_merchants;
    </select>

    <!-- 根据主键id查询数据方法 -->
    <select id="queryById" parameterType="int" resultMap="PickupMerchantsMap">
       select create_time,merchant,remark,id,user from pickup_merchants where id = #{id};
    </select>

    <!-- 根据PickupMerchants条件查询数据方法 -->
    <select id="query" resultMap="PickupMerchantsMap">
        select create_time,merchant,remark,id,user 
        from pickup_merchants 
        <where>
            <if test="id != null"> and id = #{id}</if>
            <if test="user != null">
                 <if test="user.id != null"> and user = #{user.id}</if>
            </if>
            <if test="merchant != null">
                 <if test="merchant.id != null"> and merchant = #{merchant.id}</if>
            </if>
            <if test="remark != null"> and remark = #{remark}</if>
            <if test="createTime != null"> and create_time = #{createTime}</if> 
        </where>
    </select>

    <!-- 根据PickupMerchants插入数据方法 -->
    <insert id="insert" parameterType="PickupMerchants" useGeneratedKeys="true" keyColumn="id" keyProperty="id">
        insert into pickup_merchants (id,user,merchant,remark,create_time) values 
        (
            #{id},
            #{user.id},
            #{merchant.id},
            #{remark},
            <if test="createTime != null">#{createTime}</if><if test="createTime == null">default</if>
        ); 
    </insert>

    <!-- 根据PickupMerchants插入多条数据方法 -->
    <insert id="inserts" parameterType="List" useGeneratedKeys="true" keyColumn="id" keyProperty="id">
        insert into pickup_merchants (id,user,merchant,remark,create_time) values 
        <foreach collection="pickupmerchantss" item="item" separator=",">
            (
                #{item.id},
                #{item.user.id},
                #{item.merchant.id},
                #{item.remark},
                <if test="item.createTime != null">#{item.createTime}</if><if test="item.createTime == null">default</if>
            ) 
        </foreach>
    </insert>

    <!-- 根据PickupMerchants条件修改单条数据方法,从传入对象获取主键id -->
    <update id="updateById" parameterType="PickupMerchants">
        update pickup_merchants 
        <set>
            <if test="user != null">
                <if test="user.id != null">user = #{user.id},</if>
            </if>
            <if test="merchant != null">
                <if test="merchant.id != null">merchant = #{merchant.id},</if>
            </if>
            <if test="remark != null">remark = #{remark},</if>
            <if test="createTime != null">create_time = #{createTime},</if>
        </set>
        where id = #{id}
    </update>

</mapper>